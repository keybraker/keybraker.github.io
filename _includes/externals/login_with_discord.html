<div>
    <a 
        id="login"
        class="button button_discord"
        style="color:#ffff; display: none;"
        href="https://discord.com/api/oauth2/authorize?client_id=704400876860735569&redirect_uri=https%3A%2F%2Fportal-bot.xyz%2Fpremium%2F&response_type=code&scope=identify%20guilds"
    >log in with discord</a>
    <script  type="text/javascript">
        window.onload = () => {
            console.log('inside');
            const fragment = new URLSearchParams(window.location.hash.slice(1));
            console.log('fragment: ', fragment);

            if (fragment.has("access_token")) {
                const accessToken = fragment.get("access_token");
                const tokenType = fragment.get("token_type");
                console.log('accessToken: ', accessToken);
                console.log('tokenType: ', tokenType);

                fetch('https://discordapp.com/api/users/@me', {
                    headers: {
                        authorization: `${tokenType} ${accessToken}`
                    }
                })
                    .then(res => res.json())
                    .then(response => {
                        const { username, discriminator } = response;
                        document.getElementById('info').innerText += ` ${username}#${discriminator}`;
                        console.log('username: ', username);
                        console.log('discriminator: ', discriminator);
                    })
                    .catch(console.error);
            }
            else {
                console.log('could not log in');
                document.getElementById('login').style.display = 'block';
            }
        }
    </script>
</div>